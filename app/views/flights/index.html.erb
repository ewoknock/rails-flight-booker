<h1>Flights</h1>

<div class="form-container">
        <%= form_with(url: flights_path, method: :get, class: "search-form") do |f| %>
        <div class="form-field">
            <%= f.label :departure_airport_id, 'Depart', class: "field-label" %>
            <%= f.collection_select(:departure_airport_id, Airport.all.order(:code), :id, :code, {:selected => params[:departure_airport_id], prompt: "" }) %>
        </div>
        <div class="form-field">
            <%= f.label :arrival_airport_id, 'Arrive', class: "field-label" %>
            <%= f.collection_select(:arrival_airport_id, Airport.all.order(:code), :id, :code, {:selected => params[:arrival_airport_id], prompt: "" }) %>
        </div>
        <div class="form-field">
            <%= f.label :departure_date, "Depart Date", class: "field-label" %>
            <%= f.date_field :departure_date, min: Date.today, class: "date-field", value: params[:departure_date] || Date.today.strftime("%Y-%m-%d") %>
        </div>
        <div class="form-field">
            <%= f.label :num_passengers, "Passengers", class: "field-label" %>
            <%= f.select :num_passengers, 1..4 %>
        </div>
        <%= f.submit 'Search', class: "search-button" %>
    <% end %>

</div>
<% if search_submitted? %>
<table>
    <thead>
        <tr>
            <th>Departure airport</th>
            <th>Arrival Airport</th>
            <th>Departure Time</th>
            <th>Flight Duration</th>
        </tr>
    </thead>
    <tbody>
    <% @flights.each do |flight| %>
        <tr>
            <td><%= flight.departure_airport.name %></td>
            <td><%= flight.arrival_airport.name %></td>
            <td><%= "#{flight.format_date} #{flight.format_time}" %></td>
            <td><%= Time.at(flight.flight_duration).utc.strftime("%H:%M") %></td>
        </tr>
    <% end %>
    </tbody>
</table>

<% end %>